<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting Started - PyBedquilt Documentation</title>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script>

  <style>
    body {font-size: 90%;}
    pre, code {font-size: 100%;}
    h3, h4, h5, h6 {color: #2980b9; font-weight: 300}
  </style> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> PyBedquilt Documentation</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
            <li class="toctree-l1 current">
                <a class="current" href=".">Getting Started</a>
            </li>
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href=".."></a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    <li>Getting Started</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <h1 id="getting-started">Getting Started</h1>
<p>First, install the <a href="http://bedquiltdb.github.io">BedquiltDB</a> extension on your
PostgreSQL instance, then create enable the extension on a database:</p>
<pre><code>-- in psql
CREATE DATABASE bedquilt_test;

-- connect to bedquilt_test and then run:
CREATE EXTENSION pgcrypto;
CREATE EXTENSION bedquilt;
</code></pre>

<p>Then, install the pybedquilt libary:</p>
<pre><code>$ pip install pybedquilt
</code></pre>

<h2 id="inserting-data">Inserting Data</h2>
<p>Now, let's open a python interpreter and create a <code>BedquiltClient</code>:</p>
<pre><code>$ python
&gt;&gt;&gt; import pybedquilt
&gt;&gt;&gt; client = pybedquilt.BedquiltClient(&quot;dbname=bedquilt_test&quot;)
</code></pre>

<p>Once we have a client, connected to the PostgreSQL server, we can get
a <code>BedquiltCollection</code> object:</p>
<pre><code>&gt;&gt;&gt; people = client['people']
</code></pre>

<p>Lets put some people documents in our collection:</p>
<pre><code>&gt;&gt;&gt; sarah = {
...    '_id': &quot;sarah@example.com&quot;,
...    'name': &quot;Sarah Jones&quot;,
...    'age': 27,
...    'city': &quot;Edinburgh&quot;,
...    'likes': [&quot;icecream&quot;, &quot;code&quot;, &quot;tigers&quot;]
... }
&gt;&gt;&gt; dave = {
...    'name': &quot;Dave&quot;,
...    'age': 40,
...    'city': &quot;London&quot;,
...    'likes': [&quot;code&quot;, &quot;puppies&quot;, &quot;knitting&quot;]
... }
&gt;&gt;&gt; elaine = {
...    'name': &quot;Elaine&quot;,
...    'age': 36,
...    'city': &quot;Edinburgh&quot;,
...    'likes': [&quot;board games&quot;, &quot;cider&quot;, &quot;owls&quot;]
... }
&gt;&gt;&gt; people.insert(sarah)
'sarah@example.com'
&gt;&gt;&gt; people.insert(dave)
'99a5cb8648566901436e2967'
&gt;&gt;&gt; people.insert(elaine)
'cabb5c9f6a55ecdebbc42c69'
</code></pre>

<p>As you can see, we can insert any python dictionary which can be serialized to JSON.
When we insert a document (or dict, if you prefer), the <code>insert</code> method returns the
<code>_id</code> field of the document. If the document does not have an <code>_id</code> key already,
a random one will be generated on the server. The <code>_id</code> field must be unique for
all documents in the collection.</p>
<h2 id="finding-data">Finding Data</h2>
<p>With a few (well, two) documents in our <code>people</code> collection, we can then query the
collection and see what comes back:</p>
<pre><code>&gt;&gt;&gt; people.find({'city': &quot;Edinburgh&quot;})
[{'_id': 'sarah@example.com', ....}, {'_id': 'cabb5c9f6a55ecdebbc42c69', ...}]
</code></pre>

<p>In this case we get a list of two documents back, corresponding to the two
people who live in Edinburgh, <code>sarah</code> and <code>elaine</code>.</p>
<p>The first (and only) argument to the <code>find</code> method is a query dictionary. A document
matches the query if its contents are a superset of the query data. In our example,
we're basically saying <code>"find documents where the city field is 'Edinburgh"</code>.</p>
<p>We can also query on the contents of nested JSON data structures, for example if
we wanted to get all documents where the person likes "code":</p>
<pre><code>&gt;&gt;&gt; people.find({'likes': ['code']})
[ {...}, {...} ]
</code></pre>

<p>That query returns the two documents for <code>sarah</code> and <code>dave</code>.</p>
<p>We can also limit the result set to a single document matching our query by using
<code>find_one</code> method:</p>
<pre><code>&gt;&gt;&gt; people.find_one({'likes': ['code']})
{'_id': 'sarah@example.com' ...}
</code></pre>

<p>If we know the <code>_id</code> key of a document we want, we can query for that document
directly, using <code>find_one_by_id</code>:</p>
<pre><code>&gt;&gt;&gt; people.find_one_by_id('sarah@example.com')
{'_id': 'sarah@example.com', 'name': 'Sarah Jones'...}
</code></pre>

<h2 id="updating-existing-documents">Updating Existing Documents</h2>
<p>We modify and save an existing document too, using the <code>save</code> method:</p>
<pre><code>doc = people.find_one_by_id('sarah@example.com')
doc['job'] = &quot;Web Developer&quot;
doc['likes'].append(&quot;Javascript&quot;)
people.save(doc)
</code></pre>

<p>If the saved document has an <code>_id</code> which matches a document in the collection,
it will be overwritten with the new data. If not, then <code>save</code> behaves just like the
<code>insert</code> method.</p>
<h2 id="removing-documents">Removing Documents</h2>
<p>We can delete data from a collection using the <code>remove</code>, <code>remove_one</code>
and <code>remove_one_by_id</code> methods. They work exactly as you'd expect:</p>
<pre><code>people.remove({'cool': False})
people.remove_one({'likes': ['cabbage']})
people.remove_one_by_id('magic_man@example.com')
</code></pre>


            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href=".." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
      <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>
</body>
</html>